#encoding='UTF-8'
#从resources中抽取特征

from androguard.core.bytecodes import apk, dvm
from androguard.core.analysis import analysis

from tools.string_parser import STRING_PARSER

def static_resource(app, result):
    dat = []

    try:
        rsrc = app.get_android_resources()
    except:
        rsrc = None

    if rsrc is None:
        result['resource'] = {}
        return
    pkg = rsrc.get_packages_names()[0]
    rsrc.get_strings_resources()
    #for i in rsrc.values[pkg].keys():

    for i in rsrc.values.get(pkg, {}).keys():
        if 'string' not in rsrc.values[pkg][i]:
            continue
        for duo in rsrc.values[pkg][i]['string']:
            #dat.append('"'+duo[0]+'" : "'+duo[1]+'"') 
            #dat[duo[0]] = duo[1]
            dat.append(duo[1])

    #parser = string_parser()
    result['resource'] = STRING_PARSER.parse_strings(dat)
