#encoding='UTF-8'
#从resources中抽取特征

from androguard.core.bytecodes import apk, dvm
from androguard.core.analysis import analysis

from tools.string_parser import string_parser

def static_resource(app, result):
    dat = []

    rsrc = app.get_android_resources()
    pkg = rsrc.get_packages_names()[0]
    rsrc.get_strings_resources()
    for i in rsrc.values[pkg].keys():
        for duo in rsrc.values[pkg][i]['string']:
            #dat.append('"'+duo[0]+'" : "'+duo[1]+'"') 
            #dat[duo[0]] = duo[1]
            dat.append(duo[1])

    parser = string_parser()
    result['resource'] = parser.parse_strings(dat)
    