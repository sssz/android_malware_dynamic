#encoding='UTF-8'
#总的入口

from static_manifest import static_manifest
from static_resource import static_resource
from static_dex import static_dex2


from androguard.core.bytecodes import apk, dvm
from androguard.core.analysis import analysis



def static_analysis(file_path, result):
    import time
    print(time.time())
    app = apk.APK(file_path)

    '''
        Done
            manifest: 
                permission, used-features
            dex:
                API
                String: url(host), permission, shell command, intent_filter(action), content_url
        TODO:
            manifest:
                others
            resource:
                Stings
            dex:
                #成员变量 
                #25 (0000006c) sget-object         v5, Lcom/example/intent_action/MainActivity;->tel Ljava/lang/String;
            file path
    '''
    #include permission, used-features
    #    others?
    static_manifest(app, result)

    static_resource(app, result)
    
    #TODO-如何区分自己的代码和其他的库
    #   使用https://github.com/pkumza/LiteRadar
    static_dex2(app, result)



if __name__ == "__main__":
    #file_path = "ff882679aac722d8f9ae493631e0d135b0aa281e.apk"
    file_path = "app-debug.apk"
    result = {}
    static_analysis(file_path, result)
    import json
    print(json.dumps(result))

