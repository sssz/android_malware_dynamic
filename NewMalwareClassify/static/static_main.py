#encoding='UTF-8'
#总的入口

from static_manifest import static_manifest
from static_resource import static_resource
from static_dex import static_dex2


from androguard.core.bytecodes import apk, dvm
from androguard.core.analysis import analysis



def static_analysis(file_path, result):
    import time
    print(time.time())
    app = apk.APK(file_path)

    '''not include
        content_provider path        
        file path
    '''
    #include permission, used-features
    static_manifest(app, result)

    #TODO include permission from strings.xml
    static_resource(app, result)
    
    #DONE include API, permission string from code, system_command, intent_filter(some import android system intent)
    static_dex2(app, result)



if __name__ == "__main__":
    file_path = "ff882679aac722d8f9ae493631e0d135b0aa281e.apk"
    result = {}
    static_analysis(file_path, result)
    import json
    print(json.dumps(result))

