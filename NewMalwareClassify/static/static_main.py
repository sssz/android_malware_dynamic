#encoding='UTF-8'
#总的入口

from static_manifest import static_manifest
from static_resource import static_resource
from static_dex import static_dex2


from androguard.core.bytecodes import apk, dvm
from androguard.core.analysis import analysis



def static_analysis(file_path, result):
    import time
    print(time.time())
    app = apk.APK(file_path)

    '''
        Done
            manifest: 
                permission, used-features, intent_filter
            dex:
                API
                String:
                    url(host), permission, shell command
                    intent_filter(action), content_url, file_path
        TODO:
            manifest:
                others
            resource:
                Strings
            dex:
                multidex
                static DVM Engine
x
    '''
    #include permission, used-features
    #    others?
    static_manifest(app, result)

    static_resource(app, result)
    
    static_dex2(app, result)



if __name__ == "__main__":
    #file_path = "ff882679aac722d8f9ae493631e0d135b0aa281e.apk"
    file_path = "app-debug.apk"
    file_path = "benign_ff3efaadb50ed6607a664da79ffebb09e591d563.apk"
    result = {}
    static_analysis(file_path, result)
    import json
    print(json.dumps(result))

